"use strict";(self.webpackChunkProyectoAngular=self.webpackChunkProyectoAngular||[]).push([[695],{7695:(N,f,a)=>{a.r(f),a.d(f,{MypostsModule:()=>Y});var d=a(4755),m=a(6868),t=a(2223),u=a(9166),h=a(5227),r=a(5030),_=a(5226),c=a.n(_),C=a(4655),g=a(4325);function y(o,s){1&o&&(t.TgZ(0,"small",25),t._uU(1,"The title is required"),t.qZA())}function x(o,s){if(1&o&&(t.TgZ(0,"option",26),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function P(o,s){if(1&o&&(t.TgZ(0,"div")(1,"span"),t._uU(2),t.qZA()()),2&o){const e=s.$implicit;t.xp6(2),t.Oqu(e)}}function v(o,s){1&o&&(t.TgZ(0,"small",25),t._uU(1,"You must select at least 1 category"),t.qZA())}function b(o,s){1&o&&(t.TgZ(0,"small",25),t._uU(1,"The image is required"),t.qZA())}function M(o,s){1&o&&t._UZ(0,"i",27)}let Z=(()=>{class o{constructor(e,n,i,l,p){this.categoryService=e,this.dynamicDialogRef=n,this.fb=i,this.postService=l,this.router=p,this.myForm=this.fb.group({title:["",r.kI.required],description:[""],img:["",r.kI.required],categories:this.fb.array([],r.kI.required),fileSource:[""]}),this.newCategory=this.fb.control("",r.kI.required),this.categoriesForm=[],this.addedCategories=[],this.mimeTypesAllowed=["image/jpeg","image/jpg","image/png","image/svg","image/webp"],this.json={title:"",description:"",category:[]},this.uploaded=!1}ngOnInit(){this.categoryService.getCategories().subscribe({next:e=>this.categoriesForm=e})}get categories(){return this.myForm.get("categories")}addCategory(e){this.addedCategories.push(e.target.options[e.target.options.selectedIndex].text),this.categories.push(this.fb.control(this.newCategory.value,r.kI.required)),this.newCategory.reset()}onFileChange(e){this.file=e.target.files[0],null!=this.file&&null!=this.file&&(this.file.size>1048576?(c().fire({icon:"error",title:"Wow, an error has occurred",text:"Images larger than 1 mb are not allowed"}),this.file=null):this.mimeTypesAllowed.includes(this.file?.type)?(this.myForm.patchValue({fileSource:this.file}),this.uploaded=!0):(c().fire({icon:"error",title:"Wow, an error has occurred",text:"The mimetype are not allowed"}),this.file=null))}isValidField(e){return this.myForm.controls[e].invalid&&this.myForm.controls[e].touched}closeDialog(){this.dynamicDialogRef.close()}uploadPost(){if(this.myForm.invalid)return void this.myForm.markAllAsTouched();this.json.title=this.myForm.get("title")?.value,this.json.description=this.myForm.get("description")?.value;const e=this.myForm.get("categories")?.value;for(let i=0;i<e.length;i++)this.json.category.push({id:e[i]});const n=this.myForm.get("fileSource")?.value;this.postService.uploadPost(this.json,n).subscribe({next:i=>{console.log(i),c().fire({icon:"success",title:"Successful Upload",text:`Image with name ${i.title} has been uploaded`,showConfirmButton:!0}).then(l=>{l.isConfirmed&&(this.closeDialog(),this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate(["/myposts"])}))})},error:i=>{}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(C.H),t.Y36(g.E7),t.Y36(r.qu),t.Y36(u.L),t.Y36(m.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-upload-post"]],decls:44,vars:9,consts:[[1,"mycontainer"],[1,"containerImg"],["enctype","multipart/form-data",3,"formGroup","ngSubmit"],[1,"form-group"],["for","title"],[1,"requiredField"],["type","text","name","titlePost","formControlName","title",1,"titlePost"],["class","errorMessage",4,"ngIf"],["for","description"],["name","description","cols","30","rows","5","formControlName","description",1,"description"],["for","category"],[1,"infoMessage"],["name","category",1,"category",3,"formControl","change"],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"dropzone"],["type","file","id","fileDropRef","formControlName","img",3,"change"],["for","fileDropRef"],[1,"file"],[1,"info"],[1,"name"],["class","bi bi-check-lg",4,"ngIf"],[1,"formButtons"],["type","submit",1,"submitButton"],["type","button",1,"cancelButton",3,"click"],[1,"errorMessage"],[3,"value"],[1,"bi","bi-check-lg"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2),t.NdJ("ngSubmit",function(){return n.uploadPost()}),t.TgZ(3,"div",3)(4,"label",4),t._uU(5,"Title"),t.TgZ(6,"span",5),t._uU(7,"*"),t.qZA()(),t._UZ(8,"input",6),t.YNc(9,y,2,0,"small",7),t.qZA(),t.TgZ(10,"div",3)(11,"label",8),t._uU(12,"Description"),t.qZA(),t._UZ(13,"textarea",9),t.qZA(),t.TgZ(14,"div",3)(15,"label",10),t._uU(16,"Category"),t.TgZ(17,"span",5),t._uU(18,"*"),t.qZA()(),t.TgZ(19,"small",11),t._uU(20,"(You must choose at least 1 category)"),t.qZA(),t.TgZ(21,"select",12),t.NdJ("change",function(l){return n.addCategory(l)}),t.YNc(22,x,2,2,"option",13),t.qZA(),t.YNc(23,P,3,1,"div",14),t.YNc(24,v,2,0,"small",7),t.qZA(),t.TgZ(25,"div",15)(26,"input",16),t.NdJ("change",function(l){return n.onFileChange(l)}),t.qZA(),t.TgZ(27,"h3"),t._uU(28,"Drag and drop file here"),t.qZA(),t.TgZ(29,"h3"),t._uU(30,"or"),t.qZA(),t.TgZ(31,"label",17),t._uU(32,"Browse for file"),t.qZA()(),t.YNc(33,b,2,0,"small",7),t.TgZ(34,"div",18)(35,"div",19)(36,"h4",20),t.YNc(37,M,1,0,"i",21),t._uU(38),t.qZA()()(),t.TgZ(39,"div",22)(40,"button",23),t._uU(41,"Upload"),t.qZA(),t.TgZ(42,"button",24),t.NdJ("click",function(){return n.closeDialog()}),t._uU(43,"Cancel"),t.qZA()()()()()),2&e&&(t.xp6(2),t.Q6J("formGroup",n.myForm),t.xp6(7),t.Q6J("ngIf",n.isValidField("title")),t.xp6(12),t.Q6J("formControl",n.newCategory),t.xp6(1),t.Q6J("ngForOf",n.categoriesForm),t.xp6(1),t.Q6J("ngForOf",n.addedCategories),t.xp6(1),t.Q6J("ngIf",n.isValidField("categories")),t.xp6(9),t.Q6J("ngIf",n.isValidField("img")),t.xp6(4),t.Q6J("ngIf",n.uploaded),t.xp6(1),t.hij("",null==n.file?null:n.file.name," "))},dependencies:[d.sg,d.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.oH,r.sg,r.u],styles:[".mycontainer[_ngcontent-%COMP%]{width:35vw;position:relative;z-index:2;overflow:hidden}.errorMessage[_ngcontent-%COMP%]{color:red}.infoMessage[_ngcontent-%COMP%]{font-style:italic}.bi-x-circle[_ngcontent-%COMP%]{font-size:24px}.header[_ngcontent-%COMP%]{display:flex;justify-content:center}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:10px}.dropzone[_ngcontent-%COMP%]{width:100%;height:200px;padding:2rem;text-align:center;border:dashed 1px #979797;position:relative;margin:O auto}.dropzone[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;position:absolute;z-index:2;width:100%;height:100%;top:0;left:0}.dropzone[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#fff;border-radius:5px;background-color:#4473ff;padding:10px}.bi-check-lg[_ngcontent-%COMP%]{color:green;font-size:20px}.dropzone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#38424c}.file[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-weight:700;font-size:16px}.formButtons[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px;margin:0}.formButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:7px 20px;margin:0 0 0 25px;border:none;border-radius:5px;color:#fff}.formButtons[_ngcontent-%COMP%]   .submitButton[_ngcontent-%COMP%]{background-color:green}.formButtons[_ngcontent-%COMP%]   .cancelButton[_ngcontent-%COMP%]{background-color:red}@media only screen and (max-width:480px){.mycontainer[_ngcontent-%COMP%]{width:90vw}}"]}),o})();var T=a(5289);function O(o,s){1&o&&(t.TgZ(0,"small",10),t._uU(1,"The title is required"),t.qZA())}let k=(()=>{class o{constructor(e,n,i,l){this.fb=e,this.config=n,this.postService=i,this.dynamicDialogRef=l,this.post=n.data.post}ngOnInit(){this.myForm=this.fb.group({title:[`${this.post.title}`,r.kI.required],description:[`${this.post.description}`]})}isValidField(e){return this.myForm.controls[e].invalid&&this.myForm.controls[e].touched}save(){this.myForm.invalid||this.postService.editPost(this.post.id,this.myForm.value).subscribe({next:()=>{c().fire({icon:"success",title:"Success",text:"The post was edited correctly"}).then(n=>{n.isConfirmed&&this.closeDialog()})},error:n=>{c().fire({icon:"error",title:"An error ocurred",text:n.error.message})}})}closeDialog(){this.dynamicDialogRef.close()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(g.S),t.Y36(u.L),t.Y36(g.E7))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-post-dialog"]],decls:15,vars:2,consts:[[3,"formGroup","ngSubmit"],[1,"form-group"],["for","postTile"],["type","text","name","postTitle","formControlName","title",1,"postTitle"],["class","errorMessage",4,"ngIf"],["for","description"],["name","description","cols","30","rows","5","formControlName","description",1,"description"],[1,"formButtons"],["type","submit",1,"submitButton"],["type","button",1,"cancelButton",3,"click"],[1,"errorMessage"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.save()}),t.TgZ(1,"div",1)(2,"label",2),t._uU(3,"Title"),t.qZA(),t._UZ(4,"input",3),t.YNc(5,O,2,0,"small",4),t.qZA(),t.TgZ(6,"div",1)(7,"label",5),t._uU(8,"Description"),t.qZA(),t._UZ(9,"textarea",6),t.qZA(),t.TgZ(10,"div",7)(11,"button",8),t._uU(12,"Update"),t.qZA(),t.TgZ(13,"button",9),t.NdJ("click",function(){return n.closeDialog()}),t._uU(14,"Cancel"),t.qZA()()()),2&e&&(t.Q6J("formGroup",n.myForm),t.xp6(5),t.Q6J("ngIf",n.isValidField("title")))},dependencies:[d.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u],styles:[".form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:10px}.formButtons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1em;margin:0}.formButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:7px 20px;margin:0;border:none;border-radius:5px;color:#fff}.formButtons[_ngcontent-%COMP%]   .submitButton[_ngcontent-%COMP%]{background-color:green}.formButtons[_ngcontent-%COMP%]   .cancelButton[_ngcontent-%COMP%]{background-color:red}"]}),o})();var U=a(9453);function A(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"i",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,l=t.oxw();return t.KtG(l.giveLike(i))}),t.qZA()()}}function F(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"i",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,l=t.oxw();return t.KtG(l.removeLike(i))}),t.qZA()()}}function w(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",6),t._UZ(2,"img",7),t.qZA(),t.TgZ(3,"div",8)(4,"ul"),t.YNc(5,A,2,0,"li",9),t.YNc(6,F,2,0,"ng-template",null,10,t.W1O),t.TgZ(8,"li")(9,"i",11),t.NdJ("click",function(){const l=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.openCommentDialog(l.id))}),t.qZA()(),t.TgZ(10,"li")(11,"i",12),t.NdJ("click",function(){const l=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.deletePost(l.id))}),t.qZA()(),t.TgZ(12,"li")(13,"i",13),t.NdJ("click",function(){const l=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.openEditDialog(l))}),t.qZA()()()()()}if(2&o){const e=s.$implicit,n=t.MAs(7),i=t.oxw();t.xp6(2),t.Q6J("src",e.img,t.LSH),t.xp6(3),t.Q6J("ngIf",!i.isLikedPost(e.id))("ngIfElse",n)}}let q=(()=>{class o{constructor(e,n,i,l){this.postService=e,this.likeService=n,this.router=i,this.dialogService=l,this.posts=[],this.likedPosts=[],this.visibleComments=!1}ngOnInit(){this.likeService.getLikes().subscribe({next:e=>this.likedPosts=e,error:e=>this.router.navigate(["/error"])})}openDialog(){this.dialogService.open(Z,{header:"Upload Post",baseZIndex:99999999999})}openCommentDialog(e){this.dialogService.open(T.J,{header:"Comments",data:{id:e},baseZIndex:99999999999,modal:!0})}openEditDialog(e){this.ref=this.dialogService.open(k,{header:"Edit Post",data:{post:e},baseZIndex:99999999999})}deletePost(e){c().fire({title:"Delete post",icon:"warning",text:"Are you sure to delete this post?",showCloseButton:!0,showConfirmButton:!0,confirmButtonText:"Delete",confirmButtonColor:"red"}).then(n=>{n.isConfirmed&&this.postService.deletePost(e).subscribe({next:()=>{c().fire({title:"Successfully",text:"The post has been deleted successfully",showCancelButton:!1,showConfirmButton:!0,confirmButtonText:"Cancel",confirmButtonColor:"gray"}).then(i=>{i.isConfirmed&&this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate(["/myposts"])})})}})})}isLikedPost(e){let n=!1;return 0!=this.likedPosts.length&&this.likedPosts.find(i=>{i.post.id==e&&(n=!0)}),n}giveLike(e){this.likeService.giveLike({post:{id:e.id},user:""}).subscribe({next:i=>{this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate(["/myposts"])})},error:i=>console.log(i)})}removeLike(e){this.likeService.removeLike(e.id).subscribe({next:n=>{this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate(["/myposts"])})}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.L),t.Y36(U.n),t.Y36(m.F0),t.Y36(g.xA))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-post-gallery"]],inputs:{posts:"posts"},decls:6,vars:1,consts:[[1,"row"],[1,"column"],[1,"add_post"],[1,"blur_background"],["data-toggle","tooltip","data-placement","bottom","title","Add Post",1,"bi","bi-plus-square",3,"click"],["class","column",4,"ngFor","ngForOf"],[1,"gallery-container"],[3,"src"],[1,"post_icons"],[4,"ngIf","ngIfElse"],["liked",""],[1,"bi","bi-chat",3,"click"],[1,"bi","bi-trash3-fill","text-danger",3,"click"],[1,"bi","bi-pencil",3,"click"],[1,"bi","bi-heart",3,"click"],[1,"bi","bi-heart-fill",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"div",3),t.TgZ(4,"i",4),t.NdJ("click",function(){return n.openDialog()}),t.qZA()()(),t.YNc(5,w,14,3,"div",5),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngForOf",n.posts))},dependencies:[d.sg,d.O5],styles:[".row[_ngcontent-%COMP%]{display:flex;margin:5px;flex-wrap:wrap}.column[_ngcontent-%COMP%]{flex-basis:33.3%;padding:5px;margin-bottom:30px;max-width:26.301875em;min-height:19em;max-height:19em}.add_post[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:100%}.blur_background[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#bbb;filter:blur(5px);z-index:-1}.bi-plus-square[_ngcontent-%COMP%]{z-index:111;font-size:2.2em;cursor:pointer}.gallery-container[_ngcontent-%COMP%]{height:100%}img[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;z-index:9;object-fit:fill;border-radius:4px;background-color:#fff}.post_icons[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{display:flex;justify-content:center;list-style:none;margin:5px 0 0;padding:0}.post_icons[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;font-size:20px;margin-right:20px}.bi-heart-fill[_ngcontent-%COMP%]{color:red}.containerComment[_ngcontent-%COMP%]{border:solid 1px;border-radius:3px;display:flex;flex-direction:column;padding:5px;margin-bottom:5px}.comment[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{font-weight:bolder}.formTextArea[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:5em}.commentTextArea[_ngcontent-%COMP%]{width:100%;height:100%;margin-right:2%}.sendButton[_ngcontent-%COMP%]{background-color:#4473ff;padding:5px 15px;color:#fff;border:none;border-radius:3px}.uploadDateComment[_ngcontent-%COMP%]{font-size:.8em}@media only screen and (max-width:542px){.column[_ngcontent-%COMP%]{flex-basis:100%;max-height:16em}}@media only screen and (min-width: 542px) and (max-width:850px){.column[_ngcontent-%COMP%]{flex-basis:50%}}"]}),o})();const B=[{path:"",component:(()=>{class o{constructor(e){this.postService=e,this.myPosts=[]}ngOnInit(){this.postService.getMyposts().subscribe({next:e=>this.myPosts=e,error:e=>console.log(e)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.L))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-mypost"]],decls:7,vars:1,consts:[[1,"mycontainer"],[1,"d-flex","justify-content-center"],[1,"postcontainer"],[3,"posts"],[1,"footer"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3,"My Posts"),t.qZA()(),t.TgZ(4,"div",2),t._UZ(5,"app-post-gallery",3),t.qZA(),t._UZ(6,"app-footer",4),t.qZA()),2&e&&(t.xp6(5),t.Q6J("posts",n.myPosts))},dependencies:[h.c,q],styles:[".mycontainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%}h3[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:5px;font-size:1.8em}.postcontainer[_ngcontent-%COMP%]{flex:1}.footer[_ngcontent-%COMP%]{width:70%}@media only screen and (max-width:480px){.footer[_ngcontent-%COMP%]{width:100%}}"]}),o})()}];let J=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.Bz.forChild(B),m.Bz]}),o})();var S=a(2523),D=a(1493),I=a(3608);let Y=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[g.xA],imports:[d.ez,J,S.m,r.UX,g.DL,D.S,I.z]}),o})()}}]);